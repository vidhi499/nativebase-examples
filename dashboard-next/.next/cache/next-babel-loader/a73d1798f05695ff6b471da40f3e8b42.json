{"ast":null,"code":"\"use strict\";var _regeneratorRuntime=require(\"@babel/runtime/regenerator\");var _slicedToArray=require(\"@babel/runtime/helpers/slicedToArray\");var _extends=require(\"@babel/runtime/helpers/extends\");var _classCallCheck=require(\"@babel/runtime/helpers/classCallCheck\");var _createClass=require(\"@babel/runtime/helpers/createClass\");var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{\"default\":mod};};Object.defineProperty(exports,\"__esModule\",{value:true});var url_1=require(\"url\");var mitt_1=__importDefault(require(\"../mitt\"));var utils_1=require(\"../utils\");var is_dynamic_1=require(\"./utils/is-dynamic\");var route_matcher_1=require(\"./utils/route-matcher\");var route_regex_1=require(\"./utils/route-regex\");var basePath=process.env.__NEXT_ROUTER_BASEPATH||'';function addBasePath(path){return path.indexOf(basePath)!==0?basePath+path:path;}exports.addBasePath=addBasePath;function delBasePath(path){return path.indexOf(basePath)===0?path.substr(basePath.length)||'/':path;}function toRoute(path){return path.replace(/\\/$/,'')||'/';}var prepareRoute=function prepareRoute(path){return toRoute(!path||path==='/'?'/index':path);};function fetchNextData(pathname,query,isServerRender,cb){var attempts=isServerRender?3:1;function getResponse(){return fetch(utils_1.formatWithValidation({pathname:\"/_next/data/\".concat(__NEXT_DATA__.buildId).concat(pathname,\".json\"),query:query}),{credentials:'same-origin'}).then(function(res){if(!res.ok){if(--attempts>0&&res.status>=500){return getResponse();}throw new Error(\"Failed to load static props\");}return res.json();});}return getResponse().then(function(data){return cb?cb(data):data;})[\"catch\"](function(err){if(!isServerRender){;err.code='PAGE_LOAD_ERROR';}throw err;});}var Router=function(){function Router(pathname,query,as,_ref){var _this=this;var initialProps=_ref.initialProps,pageLoader=_ref.pageLoader,App=_ref.App,wrapApp=_ref.wrapApp,Component=_ref.Component,err=_ref.err,subscription=_ref.subscription,isFallback=_ref.isFallback;_classCallCheck(this,Router);this.sdc={};this.onPopState=function(e){if(!e.state){var _pathname=_this.pathname,_query=_this.query;_this.changeState('replaceState',utils_1.formatWithValidation({pathname:_pathname,query:_query}),utils_1.getURL());return;}if(e.state&&_this.isSsr&&e.state.as===_this.asPath&&url_1.parse(e.state.url).pathname===_this.pathname){return;}if(_this._bps&&!_this._bps(e.state)){return;}var _e$state=e.state,url=_e$state.url,as=_e$state.as,options=_e$state.options;if(true){if(typeof url==='undefined'||typeof as==='undefined'){console.warn('`popstate` event triggered but `event.state` did not have `url` or `as` https://err.sh/zeit/next.js/popstate-state-empty');}}_this.replace(url,as,options);};this._getStaticData=function(asPath){var pathname=prepareRoute(url_1.parse(asPath).pathname);return false&&_this.sdc[pathname]?Promise.resolve(_this.sdc[pathname]):fetchNextData(pathname,null,_this.isSsr,function(data){return _this.sdc[pathname]=data;});};this._getServerData=function(asPath){var _url_1$parse=url_1.parse(asPath,true),pathname=_url_1$parse.pathname,query=_url_1$parse.query;pathname=prepareRoute(pathname);return fetchNextData(pathname,query,_this.isSsr);};this.route=toRoute(pathname);this.components={};if(pathname!=='/_error'){this.components[this.route]={Component:Component,props:initialProps,err:err,__N_SSG:initialProps&&initialProps.__N_SSG,__N_SSP:initialProps&&initialProps.__N_SSP};}this.components['/_app']={Component:App};this.events=Router.events;this.pageLoader=pageLoader;this.pathname=pathname;this.query=query;this.asPath=is_dynamic_1.isDynamicRoute(pathname)&&__NEXT_DATA__.autoExport?pathname:as;this.basePath=basePath;this.sub=subscription;this.clc=null;this._wrapApp=wrapApp;this.isSsr=true;this.isFallback=isFallback;if(true){this.changeState('replaceState',utils_1.formatWithValidation({pathname:pathname,query:query}),as);window.addEventListener('popstate',this.onPopState);}}_createClass(Router,[{key:\"update\",value:function update(route,mod){var Component=mod[\"default\"]||mod;var data=this.components[route];if(!data){throw new Error(\"Cannot update unavailable route: \".concat(route));}var newData=_extends(_extends({},data),{Component:Component,__N_SSG:mod.__N_SSG,__N_SSP:mod.__N_SSP});this.components[route]=newData;if(route==='/_app'){this.notify(this.components[this.route]);return;}if(route===this.route){this.notify(newData);}}},{key:\"reload\",value:function reload(){window.location.reload();}},{key:\"back\",value:function back(){window.history.back();}},{key:\"push\",value:function push(url){var as=arguments.length>1&&arguments[1]!==undefined?arguments[1]:url;var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return this.change('pushState',url,as,options);}},{key:\"replace\",value:function replace(url){var as=arguments.length>1&&arguments[1]!==undefined?arguments[1]:url;var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return this.change('replaceState',url,as,options);}},{key:\"change\",value:function change(method,_url,_as,options){var _this2=this;return new Promise(function(resolve,reject){if(!options._h){_this2.isSsr=false;}if(utils_1.ST){performance.mark('routeChange');}var url=typeof _url==='object'?utils_1.formatWithValidation(_url):_url;var as=typeof _as==='object'?utils_1.formatWithValidation(_as):_as;url=addBasePath(url);as=addBasePath(as);if(process.env.__NEXT_EXPORT_TRAILING_SLASH){var rewriteUrlForNextExport=require(\"./rewrite-url-for-export\").rewriteUrlForNextExport;if(__NEXT_DATA__.nextExport){as=rewriteUrlForNextExport(as);}}_this2.abortComponentLoad(as);if(!options._h&&_this2.onlyAHashChange(as)){_this2.asPath=as;Router.events.emit('hashChangeStart',as);_this2.changeState(method,url,as,options);_this2.scrollToHash(as);Router.events.emit('hashChangeComplete',as);return resolve(true);}var _url_1$parse2=url_1.parse(url,true),pathname=_url_1$parse2.pathname,query=_url_1$parse2.query,protocol=_url_1$parse2.protocol;if(!pathname||protocol){if(true){throw new Error(\"Invalid href passed to router: \".concat(url,\" https://err.sh/zeit/next.js/invalid-href-passed\"));}return resolve(false);}if(!_this2.urlIsNew(as)){method='replaceState';}var route=toRoute(pathname);var _options$shallow=options.shallow,shallow=_options$shallow===void 0?false:_options$shallow;if(is_dynamic_1.isDynamicRoute(route)){var _url_1$parse3=url_1.parse(as),asPathname=_url_1$parse3.pathname;var routeRegex=route_regex_1.getRouteRegex(route);var routeMatch=route_matcher_1.getRouteMatcher(routeRegex)(asPathname);if(!routeMatch){var missingParams=Object.keys(routeRegex.groups).filter(function(param){return!query[param];});if(missingParams.length>0){if(true){console.warn(\"Mismatching `as` and `href` failed to manually provide \"+\"the params: \".concat(missingParams.join(', '),\" in the `href`'s `query`\"));}return reject(new Error(\"The provided `as` value (\".concat(asPathname,\") is incompatible with the `href` value (\").concat(route,\"). \")+\"Read more: https://err.sh/zeit/next.js/incompatible-href-as\"));}}else{_extends(query,routeMatch);}}Router.events.emit('routeChangeStart',as);_this2.getRouteInfo(route,pathname,query,as,shallow).then(function(routeInfo){var error=routeInfo.error;if(error&&error.cancelled){return resolve(false);}Router.events.emit('beforeHistoryChange',as);_this2.changeState(method,url,as,options);if(true){var appComp=_this2.components['/_app'].Component;window.next.isPrerendered=appComp.getInitialProps===appComp.origGetInitialProps&&!routeInfo.Component.getInitialProps;}_this2.set(route,pathname,query,as,routeInfo);if(error){Router.events.emit('routeChangeError',error,as);throw error;}Router.events.emit('routeChangeComplete',as);return resolve(true);},reject);});}},{key:\"changeState\",value:function changeState(method,url,as){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(true){if(typeof window.history==='undefined'){console.error(\"Warning: window.history is not available.\");return;}if(typeof window.history[method]==='undefined'){console.error(\"Warning: window.history.\".concat(method,\" is not available\"));return;}}if(method!=='pushState'||utils_1.getURL()!==as){window.history[method]({url:url,as:as,options:options},'',as);}}},{key:\"getRouteInfo\",value:function getRouteInfo(route,pathname,query,as){var _this3=this;var shallow=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;var cachedRouteInfo=this.components[route];if(shallow&&cachedRouteInfo&&this.route===route){return Promise.resolve(cachedRouteInfo);}var handleError=function handleError(err,loadErrorFail){return new Promise(function(resolve){if(err.code==='PAGE_LOAD_ERROR'||loadErrorFail){window.location.href=as;err.cancelled=true;return resolve({error:err});}if(err.cancelled){return resolve({error:err});}resolve(_this3.fetchComponent('/_error').then(function(res){var Component=res.page;var routeInfo={Component:Component,err:err};return new Promise(function(resolve){_this3.getInitialProps(Component,{err:err,pathname:pathname,query:query}).then(function(props){routeInfo.props=props;routeInfo.error=err;resolve(routeInfo);},function(gipErr){console.error('Error in error page `getInitialProps`: ',gipErr);routeInfo.error=err;routeInfo.props={};resolve(routeInfo);});});})[\"catch\"](function(err){return handleError(err,true);}));});};return new Promise(function(resolve,reject){if(cachedRouteInfo){return resolve(cachedRouteInfo);}_this3.fetchComponent(route).then(function(res){return resolve({Component:res.page,__N_SSG:res.mod.__N_SSG,__N_SSP:res.mod.__N_SSP});},reject);}).then(function(routeInfo){var Component=routeInfo.Component,__N_SSG=routeInfo.__N_SSG,__N_SSP=routeInfo.__N_SSP;if(true){var _require=require('react-is'),isValidElementType=_require.isValidElementType;if(!isValidElementType(Component)){throw new Error(\"The default export is not a React Component in page: \\\"\".concat(pathname,\"\\\"\"));}}return _this3._getData(function(){return __N_SSG?_this3._getStaticData(as):__N_SSP?_this3._getServerData(as):_this3.getInitialProps(Component,{pathname:pathname,query:query,asPath:as});}).then(function(props){routeInfo.props=props;_this3.components[route]=routeInfo;return routeInfo;});})[\"catch\"](handleError);}},{key:\"set\",value:function set(route,pathname,query,as,data){this.isFallback=false;this.route=route;this.pathname=pathname;this.query=query;this.asPath=as;this.notify(data);}},{key:\"beforePopState\",value:function beforePopState(cb){this._bps=cb;}},{key:\"onlyAHashChange\",value:function onlyAHashChange(as){if(!this.asPath)return false;var _this$asPath$split=this.asPath.split('#'),_this$asPath$split2=_slicedToArray(_this$asPath$split,2),oldUrlNoHash=_this$asPath$split2[0],oldHash=_this$asPath$split2[1];var _as$split=as.split('#'),_as$split2=_slicedToArray(_as$split,2),newUrlNoHash=_as$split2[0],newHash=_as$split2[1];if(newHash&&oldUrlNoHash===newUrlNoHash&&oldHash===newHash){return true;}if(oldUrlNoHash!==newUrlNoHash){return false;}return oldHash!==newHash;}},{key:\"scrollToHash\",value:function scrollToHash(as){var _as$split3=as.split('#'),_as$split4=_slicedToArray(_as$split3,2),hash=_as$split4[1];if(hash===''){window.scrollTo(0,0);return;}var idEl=document.getElementById(hash);if(idEl){idEl.scrollIntoView();return;}var nameEl=document.getElementsByName(hash)[0];if(nameEl){nameEl.scrollIntoView();}}},{key:\"urlIsNew\",value:function urlIsNew(asPath){return this.asPath!==asPath;}},{key:\"prefetch\",value:function prefetch(url){var _this4=this;var asPath=arguments.length>1&&arguments[1]!==undefined?arguments[1]:url;var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return new Promise(function(resolve,reject){var _url_1$parse4=url_1.parse(url),pathname=_url_1$parse4.pathname,protocol=_url_1$parse4.protocol;if(!pathname||protocol){if(true){throw new Error(\"Invalid href passed to router: \".concat(url,\" https://err.sh/zeit/next.js/invalid-href-passed\"));}return;}if(true){return;}var route=delBasePath(toRoute(pathname));Promise.all([_this4.pageLoader.prefetchData(url,delBasePath(asPath)),_this4.pageLoader[options.priority?'loadPage':'prefetch'](route)]).then(function(){return resolve();},reject);});}},{key:\"fetchComponent\",value:function fetchComponent(route){var cancelled,cancel,componentResult,error;return _regeneratorRuntime.async(function fetchComponent$(_context){while(1){switch(_context.prev=_context.next){case 0:cancelled=false;cancel=this.clc=function(){cancelled=true;};route=delBasePath(route);_context.next=5;return _regeneratorRuntime.awrap(this.pageLoader.loadPage(route));case 5:componentResult=_context.sent;if(!cancelled){_context.next=10;break;}error=new Error(\"Abort fetching component for route: \\\"\".concat(route,\"\\\"\"));error.cancelled=true;throw error;case 10:if(cancel===this.clc){this.clc=null;}return _context.abrupt(\"return\",componentResult);case 12:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"_getData\",value:function _getData(fn){var _this5=this;var cancelled=false;var cancel=function cancel(){cancelled=true;};this.clc=cancel;return fn().then(function(data){if(cancel===_this5.clc){_this5.clc=null;}if(cancelled){var err=new Error('Loading initial props cancelled');err.cancelled=true;throw err;}return data;});}},{key:\"getInitialProps\",value:function getInitialProps(Component,ctx){var App=this.components['/_app'].Component;var AppTree=this._wrapApp(App);ctx.AppTree=AppTree;return utils_1.loadGetInitialProps(App,{AppTree:AppTree,Component:Component,router:this,ctx:ctx});}},{key:\"abortComponentLoad\",value:function abortComponentLoad(as){if(this.clc){var e=new Error('Route Cancelled');e.cancelled=true;Router.events.emit('routeChangeError',e,as);this.clc();this.clc=null;}}},{key:\"notify\",value:function notify(data){this.sub(data,this.components['/_app'].Component);}}],[{key:\"_rewriteUrlForNextExport\",value:function _rewriteUrlForNextExport(url){if(process.env.__NEXT_EXPORT_TRAILING_SLASH){var rewriteUrlForNextExport=require(\"./rewrite-url-for-export\").rewriteUrlForNextExport;return rewriteUrlForNextExport(url);}else{return url;}}}]);return Router;}();exports[\"default\"]=Router;Router.events=mitt_1[\"default\"]();","map":{"version":3,"sources":["/Users/vidhi/Sites/Projects/examples/test/dashboard-next/node_modules/next/dist/next-server/lib/router/router.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","url_1","require","mitt_1","utils_1","is_dynamic_1","route_matcher_1","route_regex_1","basePath","process","env","__NEXT_ROUTER_BASEPATH","addBasePath","path","indexOf","delBasePath","substr","length","toRoute","replace","prepareRoute","fetchNextData","pathname","query","isServerRender","cb","attempts","getResponse","fetch","formatWithValidation","__NEXT_DATA__","buildId","credentials","then","res","ok","status","Error","json","data","err","code","Router","as","initialProps","pageLoader","App","wrapApp","Component","subscription","isFallback","sdc","onPopState","e","state","changeState","getURL","isSsr","asPath","parse","url","_bps","options","console","warn","_getStaticData","Promise","resolve","_getServerData","route","components","props","__N_SSG","__N_SSP","events","isDynamicRoute","autoExport","sub","clc","_wrapApp","window","addEventListener","newData","notify","location","reload","history","back","change","method","_url","_as","reject","_h","ST","performance","mark","__NEXT_EXPORT_TRAILING_SLASH","rewriteUrlForNextExport","nextExport","abortComponentLoad","onlyAHashChange","emit","scrollToHash","protocol","urlIsNew","shallow","asPathname","routeRegex","getRouteRegex","routeMatch","getRouteMatcher","missingParams","keys","groups","filter","param","join","getRouteInfo","routeInfo","error","cancelled","appComp","next","isPrerendered","getInitialProps","origGetInitialProps","set","cachedRouteInfo","handleError","loadErrorFail","href","fetchComponent","page","gipErr","isValidElementType","_getData","split","oldUrlNoHash","oldHash","newUrlNoHash","newHash","hash","scrollTo","idEl","document","getElementById","scrollIntoView","nameEl","getElementsByName","all","prefetchData","priority","cancel","loadPage","componentResult","fn","ctx","AppTree","loadGetInitialProps","router"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst url_1 = require(\"url\");\nconst mitt_1 = __importDefault(require(\"../mitt\"));\nconst utils_1 = require(\"../utils\");\nconst is_dynamic_1 = require(\"./utils/is-dynamic\");\nconst route_matcher_1 = require(\"./utils/route-matcher\");\nconst route_regex_1 = require(\"./utils/route-regex\");\nconst basePath = process.env.__NEXT_ROUTER_BASEPATH || '';\nfunction addBasePath(path) {\n    return path.indexOf(basePath) !== 0 ? basePath + path : path;\n}\nexports.addBasePath = addBasePath;\nfunction delBasePath(path) {\n    return path.indexOf(basePath) === 0\n        ? path.substr(basePath.length) || '/'\n        : path;\n}\nfunction toRoute(path) {\n    return path.replace(/\\/$/, '') || '/';\n}\nconst prepareRoute = (path) => toRoute(!path || path === '/' ? '/index' : path);\nfunction fetchNextData(pathname, query, isServerRender, cb) {\n    let attempts = isServerRender ? 3 : 1;\n    function getResponse() {\n        return fetch(utils_1.formatWithValidation({\n            // @ts-ignore __NEXT_DATA__\n            pathname: `/_next/data/${__NEXT_DATA__.buildId}${pathname}.json`,\n            query,\n        }), {\n            // Cookies are required to be present for Next.js' SSG \"Preview Mode\".\n            // Cookies may also be required for `getServerSideProps`.\n            //\n            // > `fetch` won’t send cookies, unless you set the credentials init\n            // > option.\n            // https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\n            //\n            // > For maximum browser compatibility when it comes to sending &\n            // > receiving cookies, always supply the `credentials: 'same-origin'`\n            // > option instead of relying on the default.\n            // https://github.com/github/fetch#caveats\n            credentials: 'same-origin',\n        }).then(res => {\n            if (!res.ok) {\n                if (--attempts > 0 && res.status >= 500) {\n                    return getResponse();\n                }\n                throw new Error(`Failed to load static props`);\n            }\n            return res.json();\n        });\n    }\n    return getResponse()\n        .then(data => {\n        return cb ? cb(data) : data;\n    })\n        .catch((err) => {\n        // We should only trigger a server-side transition if this was caused\n        // on a client-side transition. Otherwise, we'd get into an infinite\n        // loop.\n        if (!isServerRender) {\n            ;\n            err.code = 'PAGE_LOAD_ERROR';\n        }\n        throw err;\n    });\n}\nclass Router {\n    constructor(pathname, query, as, { initialProps, pageLoader, App, wrapApp, Component, err, subscription, isFallback, }) {\n        // Static Data Cache\n        this.sdc = {};\n        this.onPopState = (e) => {\n            if (!e.state) {\n                // We get state as undefined for two reasons.\n                //  1. With older safari (< 8) and older chrome (< 34)\n                //  2. When the URL changed with #\n                //\n                // In the both cases, we don't need to proceed and change the route.\n                // (as it's already changed)\n                // But we can simply replace the state with the new changes.\n                // Actually, for (1) we don't need to nothing. But it's hard to detect that event.\n                // So, doing the following for (1) does no harm.\n                const { pathname, query } = this;\n                this.changeState('replaceState', utils_1.formatWithValidation({ pathname, query }), utils_1.getURL());\n                return;\n            }\n            // Make sure we don't re-render on initial load,\n            // can be caused by navigating back from an external site\n            if (e.state &&\n                this.isSsr &&\n                e.state.as === this.asPath &&\n                url_1.parse(e.state.url).pathname === this.pathname) {\n                return;\n            }\n            // If the downstream application returns falsy, return.\n            // They will then be responsible for handling the event.\n            if (this._bps && !this._bps(e.state)) {\n                return;\n            }\n            const { url, as, options } = e.state;\n            if (process.env.NODE_ENV !== 'production') {\n                if (typeof url === 'undefined' || typeof as === 'undefined') {\n                    console.warn('`popstate` event triggered but `event.state` did not have `url` or `as` https://err.sh/zeit/next.js/popstate-state-empty');\n                }\n            }\n            this.replace(url, as, options);\n        };\n        this._getStaticData = (asPath) => {\n            const pathname = prepareRoute(url_1.parse(asPath).pathname);\n            return process.env.NODE_ENV === 'production' && this.sdc[pathname]\n                ? Promise.resolve(this.sdc[pathname])\n                : fetchNextData(pathname, null, this.isSsr, data => (this.sdc[pathname] = data));\n        };\n        this._getServerData = (asPath) => {\n            let { pathname, query } = url_1.parse(asPath, true);\n            pathname = prepareRoute(pathname);\n            return fetchNextData(pathname, query, this.isSsr);\n        };\n        // represents the current component key\n        this.route = toRoute(pathname);\n        // set up the component cache (by route keys)\n        this.components = {};\n        // We should not keep the cache, if there's an error\n        // Otherwise, this cause issues when when going back and\n        // come again to the errored page.\n        if (pathname !== '/_error') {\n            this.components[this.route] = {\n                Component,\n                props: initialProps,\n                err,\n                __N_SSG: initialProps && initialProps.__N_SSG,\n                __N_SSP: initialProps && initialProps.__N_SSP,\n            };\n        }\n        this.components['/_app'] = { Component: App };\n        // Backwards compat for Router.router.events\n        // TODO: Should be remove the following major version as it was never documented\n        this.events = Router.events;\n        this.pageLoader = pageLoader;\n        this.pathname = pathname;\n        this.query = query;\n        // if auto prerendered and dynamic route wait to update asPath\n        // until after mount to prevent hydration mismatch\n        this.asPath =\n            // @ts-ignore this is temporarily global (attached to window)\n            is_dynamic_1.isDynamicRoute(pathname) && __NEXT_DATA__.autoExport ? pathname : as;\n        this.basePath = basePath;\n        this.sub = subscription;\n        this.clc = null;\n        this._wrapApp = wrapApp;\n        // make sure to ignore extra popState in safari on navigating\n        // back from external site\n        this.isSsr = true;\n        this.isFallback = isFallback;\n        if (typeof window !== 'undefined') {\n            // in order for `e.state` to work on the `onpopstate` event\n            // we have to register the initial route upon initialization\n            this.changeState('replaceState', utils_1.formatWithValidation({ pathname, query }), as);\n            window.addEventListener('popstate', this.onPopState);\n        }\n    }\n    // @deprecated backwards compatibility even though it's a private method.\n    static _rewriteUrlForNextExport(url) {\n        if (process.env.__NEXT_EXPORT_TRAILING_SLASH) {\n            const rewriteUrlForNextExport = require('./rewrite-url-for-export')\n                .rewriteUrlForNextExport;\n            return rewriteUrlForNextExport(url);\n        }\n        else {\n            return url;\n        }\n    }\n    update(route, mod) {\n        const Component = mod.default || mod;\n        const data = this.components[route];\n        if (!data) {\n            throw new Error(`Cannot update unavailable route: ${route}`);\n        }\n        const newData = Object.assign(Object.assign({}, data), { Component, __N_SSG: mod.__N_SSG, __N_SSP: mod.__N_SSP });\n        this.components[route] = newData;\n        // pages/_app.js updated\n        if (route === '/_app') {\n            this.notify(this.components[this.route]);\n            return;\n        }\n        if (route === this.route) {\n            this.notify(newData);\n        }\n    }\n    reload() {\n        window.location.reload();\n    }\n    /**\n     * Go back in history\n     */\n    back() {\n        window.history.back();\n    }\n    /**\n     * Performs a `pushState` with arguments\n     * @param url of the route\n     * @param as masks `url` for the browser\n     * @param options object you can define `shallow` and other options\n     */\n    push(url, as = url, options = {}) {\n        return this.change('pushState', url, as, options);\n    }\n    /**\n     * Performs a `replaceState` with arguments\n     * @param url of the route\n     * @param as masks `url` for the browser\n     * @param options object you can define `shallow` and other options\n     */\n    replace(url, as = url, options = {}) {\n        return this.change('replaceState', url, as, options);\n    }\n    change(method, _url, _as, options) {\n        return new Promise((resolve, reject) => {\n            if (!options._h) {\n                this.isSsr = false;\n            }\n            // marking route changes as a navigation start entry\n            if (utils_1.ST) {\n                performance.mark('routeChange');\n            }\n            // If url and as provided as an object representation,\n            // we'll format them into the string version here.\n            let url = typeof _url === 'object' ? utils_1.formatWithValidation(_url) : _url;\n            let as = typeof _as === 'object' ? utils_1.formatWithValidation(_as) : _as;\n            url = addBasePath(url);\n            as = addBasePath(as);\n            // Add the ending slash to the paths. So, we can serve the\n            // \"<page>/index.html\" directly for the SSR page.\n            if (process.env.__NEXT_EXPORT_TRAILING_SLASH) {\n                const rewriteUrlForNextExport = require('./rewrite-url-for-export')\n                    .rewriteUrlForNextExport;\n                // @ts-ignore this is temporarily global (attached to window)\n                if (__NEXT_DATA__.nextExport) {\n                    as = rewriteUrlForNextExport(as);\n                }\n            }\n            this.abortComponentLoad(as);\n            // If the url change is only related to a hash change\n            // We should not proceed. We should only change the state.\n            // WARNING: `_h` is an internal option for handing Next.js client-side\n            // hydration. Your app should _never_ use this property. It may change at\n            // any time without notice.\n            if (!options._h && this.onlyAHashChange(as)) {\n                this.asPath = as;\n                Router.events.emit('hashChangeStart', as);\n                this.changeState(method, url, as, options);\n                this.scrollToHash(as);\n                Router.events.emit('hashChangeComplete', as);\n                return resolve(true);\n            }\n            const { pathname, query, protocol } = url_1.parse(url, true);\n            if (!pathname || protocol) {\n                if (process.env.NODE_ENV !== 'production') {\n                    throw new Error(`Invalid href passed to router: ${url} https://err.sh/zeit/next.js/invalid-href-passed`);\n                }\n                return resolve(false);\n            }\n            // If asked to change the current URL we should reload the current page\n            // (not location.reload() but reload getInitialProps and other Next.js stuffs)\n            // We also need to set the method = replaceState always\n            // as this should not go into the history (That's how browsers work)\n            // We should compare the new asPath to the current asPath, not the url\n            if (!this.urlIsNew(as)) {\n                method = 'replaceState';\n            }\n            const route = toRoute(pathname);\n            const { shallow = false } = options;\n            if (is_dynamic_1.isDynamicRoute(route)) {\n                const { pathname: asPathname } = url_1.parse(as);\n                const routeRegex = route_regex_1.getRouteRegex(route);\n                const routeMatch = route_matcher_1.getRouteMatcher(routeRegex)(asPathname);\n                if (!routeMatch) {\n                    const missingParams = Object.keys(routeRegex.groups).filter(param => !query[param]);\n                    if (missingParams.length > 0) {\n                        if (process.env.NODE_ENV !== 'production') {\n                            console.warn(`Mismatching \\`as\\` and \\`href\\` failed to manually provide ` +\n                                `the params: ${missingParams.join(', ')} in the \\`href\\`'s \\`query\\``);\n                        }\n                        return reject(new Error(`The provided \\`as\\` value (${asPathname}) is incompatible with the \\`href\\` value (${route}). ` +\n                            `Read more: https://err.sh/zeit/next.js/incompatible-href-as`));\n                    }\n                }\n                else {\n                    // Merge params into `query`, overwriting any specified in search\n                    Object.assign(query, routeMatch);\n                }\n            }\n            Router.events.emit('routeChangeStart', as);\n            // If shallow is true and the route exists in the router cache we reuse the previous result\n            this.getRouteInfo(route, pathname, query, as, shallow).then(routeInfo => {\n                const { error } = routeInfo;\n                if (error && error.cancelled) {\n                    return resolve(false);\n                }\n                Router.events.emit('beforeHistoryChange', as);\n                this.changeState(method, url, as, options);\n                if (process.env.NODE_ENV !== 'production') {\n                    const appComp = this.components['/_app'].Component;\n                    window.next.isPrerendered =\n                        appComp.getInitialProps === appComp.origGetInitialProps &&\n                            !routeInfo.Component.getInitialProps;\n                }\n                this.set(route, pathname, query, as, routeInfo);\n                if (error) {\n                    Router.events.emit('routeChangeError', error, as);\n                    throw error;\n                }\n                Router.events.emit('routeChangeComplete', as);\n                return resolve(true);\n            }, reject);\n        });\n    }\n    changeState(method, url, as, options = {}) {\n        if (process.env.NODE_ENV !== 'production') {\n            if (typeof window.history === 'undefined') {\n                console.error(`Warning: window.history is not available.`);\n                return;\n            }\n            if (typeof window.history[method] === 'undefined') {\n                console.error(`Warning: window.history.${method} is not available`);\n                return;\n            }\n        }\n        if (method !== 'pushState' || utils_1.getURL() !== as) {\n            window.history[method]({\n                url,\n                as,\n                options,\n            }, \n            // Most browsers currently ignores this parameter, although they may use it in the future.\n            // Passing the empty string here should be safe against future changes to the method.\n            // https://developer.mozilla.org/en-US/docs/Web/API/History/replaceState\n            '', as);\n        }\n    }\n    getRouteInfo(route, pathname, query, as, shallow = false) {\n        const cachedRouteInfo = this.components[route];\n        // If there is a shallow route transition possible\n        // If the route is already rendered on the screen.\n        if (shallow && cachedRouteInfo && this.route === route) {\n            return Promise.resolve(cachedRouteInfo);\n        }\n        const handleError = (err, loadErrorFail) => {\n            return new Promise(resolve => {\n                if (err.code === 'PAGE_LOAD_ERROR' || loadErrorFail) {\n                    // If we can't load the page it could be one of following reasons\n                    //  1. Page doesn't exists\n                    //  2. Page does exist in a different zone\n                    //  3. Internal error while loading the page\n                    // So, doing a hard reload is the proper way to deal with this.\n                    window.location.href = as;\n                    // Changing the URL doesn't block executing the current code path.\n                    // So, we need to mark it as a cancelled error and stop the routing logic.\n                    err.cancelled = true;\n                    // @ts-ignore TODO: fix the control flow here\n                    return resolve({ error: err });\n                }\n                if (err.cancelled) {\n                    // @ts-ignore TODO: fix the control flow here\n                    return resolve({ error: err });\n                }\n                resolve(this.fetchComponent('/_error')\n                    .then(res => {\n                    const { page: Component } = res;\n                    const routeInfo = { Component, err };\n                    return new Promise(resolve => {\n                        this.getInitialProps(Component, {\n                            err,\n                            pathname,\n                            query,\n                        }).then(props => {\n                            routeInfo.props = props;\n                            routeInfo.error = err;\n                            resolve(routeInfo);\n                        }, gipErr => {\n                            console.error('Error in error page `getInitialProps`: ', gipErr);\n                            routeInfo.error = err;\n                            routeInfo.props = {};\n                            resolve(routeInfo);\n                        });\n                    });\n                })\n                    .catch(err => handleError(err, true)));\n            });\n        };\n        return new Promise((resolve, reject) => {\n            if (cachedRouteInfo) {\n                return resolve(cachedRouteInfo);\n            }\n            this.fetchComponent(route).then(res => resolve({\n                Component: res.page,\n                __N_SSG: res.mod.__N_SSG,\n                __N_SSP: res.mod.__N_SSP,\n            }), reject);\n        })\n            .then((routeInfo) => {\n            const { Component, __N_SSG, __N_SSP } = routeInfo;\n            if (process.env.NODE_ENV !== 'production') {\n                const { isValidElementType } = require('react-is');\n                if (!isValidElementType(Component)) {\n                    throw new Error(`The default export is not a React Component in page: \"${pathname}\"`);\n                }\n            }\n            return this._getData(() => __N_SSG\n                ? this._getStaticData(as)\n                : __N_SSP\n                    ? this._getServerData(as)\n                    : this.getInitialProps(Component, \n                    // we provide AppTree later so this needs to be `any`\n                    {\n                        pathname,\n                        query,\n                        asPath: as,\n                    })).then(props => {\n                routeInfo.props = props;\n                this.components[route] = routeInfo;\n                return routeInfo;\n            });\n        })\n            .catch(handleError);\n    }\n    set(route, pathname, query, as, data) {\n        this.isFallback = false;\n        this.route = route;\n        this.pathname = pathname;\n        this.query = query;\n        this.asPath = as;\n        this.notify(data);\n    }\n    /**\n     * Callback to execute before replacing router state\n     * @param cb callback to be executed\n     */\n    beforePopState(cb) {\n        this._bps = cb;\n    }\n    onlyAHashChange(as) {\n        if (!this.asPath)\n            return false;\n        const [oldUrlNoHash, oldHash] = this.asPath.split('#');\n        const [newUrlNoHash, newHash] = as.split('#');\n        // Makes sure we scroll to the provided hash if the url/hash are the same\n        if (newHash && oldUrlNoHash === newUrlNoHash && oldHash === newHash) {\n            return true;\n        }\n        // If the urls are change, there's more than a hash change\n        if (oldUrlNoHash !== newUrlNoHash) {\n            return false;\n        }\n        // If the hash has changed, then it's a hash only change.\n        // This check is necessary to handle both the enter and\n        // leave hash === '' cases. The identity case falls through\n        // and is treated as a next reload.\n        return oldHash !== newHash;\n    }\n    scrollToHash(as) {\n        const [, hash] = as.split('#');\n        // Scroll to top if the hash is just `#` with no value\n        if (hash === '') {\n            window.scrollTo(0, 0);\n            return;\n        }\n        // First we check if the element by id is found\n        const idEl = document.getElementById(hash);\n        if (idEl) {\n            idEl.scrollIntoView();\n            return;\n        }\n        // If there's no element with the id, we check the `name` property\n        // To mirror browsers\n        const nameEl = document.getElementsByName(hash)[0];\n        if (nameEl) {\n            nameEl.scrollIntoView();\n        }\n    }\n    urlIsNew(asPath) {\n        return this.asPath !== asPath;\n    }\n    /**\n     * Prefetch page code, you may wait for the data during page rendering.\n     * This feature only works in production!\n     * @param url the href of prefetched page\n     * @param asPath the as path of the prefetched page\n     */\n    prefetch(url, asPath = url, options = {}) {\n        return new Promise((resolve, reject) => {\n            const { pathname, protocol } = url_1.parse(url);\n            if (!pathname || protocol) {\n                if (process.env.NODE_ENV !== 'production') {\n                    throw new Error(`Invalid href passed to router: ${url} https://err.sh/zeit/next.js/invalid-href-passed`);\n                }\n                return;\n            }\n            // Prefetch is not supported in development mode because it would trigger on-demand-entries\n            if (process.env.NODE_ENV !== 'production') {\n                return;\n            }\n            const route = delBasePath(toRoute(pathname));\n            Promise.all([\n                this.pageLoader.prefetchData(url, delBasePath(asPath)),\n                this.pageLoader[options.priority ? 'loadPage' : 'prefetch'](route),\n            ]).then(() => resolve(), reject);\n        });\n    }\n    async fetchComponent(route) {\n        let cancelled = false;\n        const cancel = (this.clc = () => {\n            cancelled = true;\n        });\n        route = delBasePath(route);\n        const componentResult = await this.pageLoader.loadPage(route);\n        if (cancelled) {\n            const error = new Error(`Abort fetching component for route: \"${route}\"`);\n            error.cancelled = true;\n            throw error;\n        }\n        if (cancel === this.clc) {\n            this.clc = null;\n        }\n        return componentResult;\n    }\n    _getData(fn) {\n        let cancelled = false;\n        const cancel = () => {\n            cancelled = true;\n        };\n        this.clc = cancel;\n        return fn().then(data => {\n            if (cancel === this.clc) {\n                this.clc = null;\n            }\n            if (cancelled) {\n                const err = new Error('Loading initial props cancelled');\n                err.cancelled = true;\n                throw err;\n            }\n            return data;\n        });\n    }\n    getInitialProps(Component, ctx) {\n        const { Component: App } = this.components['/_app'];\n        const AppTree = this._wrapApp(App);\n        ctx.AppTree = AppTree;\n        return utils_1.loadGetInitialProps(App, {\n            AppTree,\n            Component,\n            router: this,\n            ctx,\n        });\n    }\n    abortComponentLoad(as) {\n        if (this.clc) {\n            const e = new Error('Route Cancelled');\n            e.cancelled = true;\n            Router.events.emit('routeChangeError', e, as);\n            this.clc();\n            this.clc = null;\n        }\n    }\n    notify(data) {\n        this.sub(data, this.components['/_app'].Component);\n    }\n}\nexports.default = Router;\nRouter.events = mitt_1.default();\n"]},"metadata":{},"sourceType":"script"}