{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"@babel/runtime/helpers/slicedToArray\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\n\nvar _assertThisInitialized = require(\"@babel/runtime/helpers/assertThisInitialized\");\n\nvar _inherits = require(\"@babel/runtime/helpers/inherits\");\n\nvar _possibleConstructorReturn = require(\"@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"@babel/runtime/helpers/getPrototypeOf\");\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Menu = exports.MenuContext = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactNative = require(\"react-native-web/dist/index\");\n\nvar _getContainerStyles = require(\"./utils/getContainerStyles\");\n\nvar _hooks = require(\"../../../hooks\");\n\nvar _utils = require(\"../../../theme/tools/utils\");\n\nvar _native = _interopRequireDefault(require(\"styled-components/native\"));\n\nvar _styledSystem = require(\"styled-system\");\n\nvar _customProps = require(\"../../../utils/customProps\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar STATES = {\n  HIDDEN: 'HIDDEN',\n  ANIMATING: 'ANIMATING',\n  SHOWN: 'SHOWN'\n};\nvar animationDuration = 300;\n\nvar EASING = _reactNative.Easing.bezier(0.4, 0, 0.2, 1);\n\nvar MenuContext = _react[\"default\"].createContext({\n  open: false,\n  closeMenu: function closeMenu() {}\n});\n\nexports.MenuContext = MenuContext;\nvar StyleAnimatedView = (0, _native[\"default\"])(_reactNative.Animated.View)(_styledSystem.color, _styledSystem.space, _styledSystem.layout, _styledSystem.flexbox, _styledSystem.border, _styledSystem.typography, _customProps.customBorder, _customProps.customBackground, _customProps.customOutline, _customProps.customShadow, _customProps.customExtra, _customProps.customTypography, _customProps.customLayout);\n\nvar MenuClass = function (_react$default$Compon) {\n  _inherits(MenuClass, _react$default$Compon);\n\n  var _super = _createSuper(MenuClass);\n\n  function MenuClass(props) {\n    var _this;\n\n    _classCallCheck(this, MenuClass);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"_container\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"_onMenuLayout\", function (e) {\n      if (_this.state.menuState === STATES.ANIMATING) {\n        return;\n      }\n\n      var _e$nativeEvent$layout = e.nativeEvent.layout,\n          width = _e$nativeEvent$layout.width,\n          height = _e$nativeEvent$layout.height;\n\n      _this.setState({\n        menuState: STATES.ANIMATING,\n        menuWidth: width,\n        menuHeight: height\n      }, function () {\n        _reactNative.Animated.parallel([_reactNative.Animated.timing(_this.state.menuSizeAnimation, {\n          toValue: {\n            x: width,\n            y: height\n          },\n          duration: _reactNative.Platform.OS === 'ios' ? animationDuration : 10,\n          easing: _reactNative.Easing.bezier(0.01, 1.3, 0.77, 0.91),\n          useNativeDriver: _reactNative.Platform.OS !== 'web'\n        }), _reactNative.Animated.timing(_this.state.opacityAnimation, {\n          toValue: 1,\n          duration: animationDuration,\n          easing: EASING,\n          useNativeDriver: _reactNative.Platform.OS !== 'web'\n        })]).start();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"show\", function () {\n      if (_this._container) {\n        _this._container.measureInWindow(function (left, top, buttonWidth, buttonHeight) {\n          _this.setState({\n            buttonHeight: buttonHeight,\n            buttonWidth: buttonWidth,\n            left: left,\n            menuState: STATES.SHOWN,\n            top: top\n          });\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"hide\", function (onHidden) {\n      _reactNative.Animated.timing(_this.state.opacityAnimation, {\n        toValue: 0,\n        duration: animationDuration,\n        easing: EASING,\n        useNativeDriver: _reactNative.Platform.OS !== 'web'\n      }).start(function () {\n        _this.setState({\n          menuState: STATES.HIDDEN,\n          menuSizeAnimation: new _reactNative.Animated.ValueXY({\n            x: 0,\n            y: 0\n          }),\n          opacityAnimation: new _reactNative.Animated.Value(0)\n        }, function () {\n          if (onHidden) {\n            onHidden();\n          }\n\n          if (_reactNative.Platform.OS !== 'ios' && _this.props.onClose) {\n            _this.props.onClose();\n          }\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_hide\", function () {\n      _this.hide();\n    });\n\n    _this.state = {\n      open: false,\n      menuState: STATES.HIDDEN,\n      top: 0,\n      left: 0,\n      menuWidth: 0,\n      menuHeight: 0,\n      buttonWidth: 0,\n      buttonHeight: 0,\n      menuSizeAnimation: new _reactNative.Animated.ValueXY({\n        x: 0,\n        y: 0\n      }),\n      opacityAnimation: new _reactNative.Animated.Value(0)\n    };\n    return _this;\n  }\n\n  _createClass(MenuClass, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          menuSizeAnimation = _this$state.menuSizeAnimation,\n          menuWidth = _this$state.menuWidth,\n          menuHeight = _this$state.menuHeight,\n          buttonWidth = _this$state.buttonWidth,\n          buttonHeight = _this$state.buttonHeight,\n          opacityAnimation = _this$state.opacityAnimation;\n\n      var _ref = (0, _getContainerStyles.getContainerStyles)(this.state.top, this.state.left, menuSizeAnimation, menuWidth, menuHeight, buttonWidth, buttonHeight, opacityAnimation),\n          menuSize = _ref.menuSize,\n          menuContainerStyle = _ref.menuContainerStyle;\n\n      var menuState = this.state.menuState;\n      var animationStarted = menuState === STATES.ANIMATING;\n      var modalVisible = menuState === STATES.SHOWN || animationStarted;\n      var _this$props = this.props,\n          testID = _this$props.testID,\n          trigger = _this$props.trigger,\n          style = _this$props.style,\n          children = _this$props.children,\n          onOpen = _this$props.onOpen,\n          onClose = _this$props.onClose,\n          _this$props$closeOnSe = _this$props.closeOnSelect,\n          closeOnSelect = _this$props$closeOnSe === void 0 ? true : _this$props$closeOnSe;\n\n      var closeMenu = function closeMenu() {\n        onClose && onClose();\n\n        _this2.hide();\n      };\n\n      var triggerElement = trigger ? trigger({\n        onPress: function onPress() {\n          if (_this2.state.open) {\n            closeMenu();\n          } else {\n            _this2.show();\n\n            onOpen && onOpen();\n          }\n        }\n      }, {\n        open: this.state.open\n      }) : null;\n\n      var _ref2 = (0, _utils.extractInObject)(this.props, ['borderRadius', 'bg', 'backgroundColor', 'shadowOffset', 'shadowColor', 'elevation', 'shadowOpacity', 'shadowRadius']),\n          _ref3 = _slicedToArray(_ref2, 1),\n          shadowContainerProps = _ref3[0];\n\n      return _react[\"default\"].createElement(MenuContext.Provider, {\n        value: {\n          open: this.state.open,\n          closeMenu: closeMenu,\n          closeOnSelect: closeOnSelect\n        }\n      }, _react[\"default\"].createElement(_reactNative.View, {\n        ref: function ref(_ref4) {\n          _this2._container = _ref4;\n        },\n        collapsable: false,\n        testID: testID\n      }, triggerElement, _react[\"default\"].createElement(_reactNative.Modal, {\n        visible: modalVisible,\n        onRequestClose: this._hide,\n        supportedOrientations: ['portrait', 'portrait-upside-down', 'landscape', 'landscape-left', 'landscape-right'],\n        transparent: true\n      }, _react[\"default\"].createElement(_reactNative.TouchableWithoutFeedback, {\n        onPress: this._hide\n      }, _react[\"default\"].createElement(_reactNative.View, {\n        style: _reactNative.StyleSheet.absoluteFill\n      }, _react[\"default\"].createElement(StyleAnimatedView, _extends({\n        onLayout: this._onMenuLayout,\n        position: \"absolute\",\n        opacity: 0\n      }, shadowContainerProps, {\n        style: [menuContainerStyle, style]\n      }), _react[\"default\"].createElement(StyleAnimatedView, {\n        style: [animationStarted && menuSize]\n      }, children)))))));\n    }\n  }]);\n\n  return MenuClass;\n}(_react[\"default\"].Component);\n\nvar Menu = function Menu(props) {\n  var newProps = (0, _hooks.usePropsConfig)('Menu', props);\n  return _react[\"default\"].createElement(MenuClass, newProps);\n};\n\nexports.Menu = Menu;","map":{"version":3,"sources":["Menu.tsx"],"names":["STATES","HIDDEN","ANIMATING","SHOWN","animationDuration","EASING","Easing","MenuContext","open","closeMenu","StyleAnimatedView","Animated","color","space","layout","flexbox","border","typography","customBorder","customBackground","customOutline","customShadow","customExtra","customTypography","customLayout","React","constructor","menuState","top","left","menuWidth","menuHeight","buttonWidth","buttonHeight","menuSizeAnimation","x","y","opacityAnimation","e","height","toValue","duration","Platform","easing","useNativeDriver","onHidden","menuContainerStyle","animationStarted","modalVisible","closeOnSelect","onClose","triggerElement","trigger","onPress","onOpen","ref","testID","_hide","StyleSheet","absoluteFill","Menu","props","newProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {\n  Animated,\n  Easing,\n  Modal,\n  Platform,\n  StyleSheet,\n  TouchableWithoutFeedback,\n  View,\n} from 'react-native';\nimport { getContainerStyles } from './utils/getContainerStyles';\nimport type { IMenuProps, IMenuContextProps } from './props';\nimport type { IBoxProps } from '../../primitives';\nimport { usePropsConfig } from '../../../hooks';\nimport { extractInObject } from '../../../theme/tools/utils';\nimport styled from 'styled-components/native';\nimport {\n  border,\n  color,\n  flexbox,\n  layout,\n  space,\n  typography,\n} from 'styled-system';\nimport {\n  customBorder,\n  customBackground,\n  customOutline,\n  customLayout,\n  customExtra,\n  customShadow,\n  customTypography,\n} from '../../../utils/customProps';\n\nconst STATES = {\n  HIDDEN: 'HIDDEN',\n  ANIMATING: 'ANIMATING',\n  SHOWN: 'SHOWN',\n};\nconst animationDuration = 300;\nconst EASING = Easing.bezier(0.4, 0, 0.2, 1);\n\nexport const MenuContext = React.createContext<IMenuContextProps>({\n  open: false,\n  closeMenu: () => {},\n});\n\nconst StyleAnimatedView = styled(Animated.View)<IBoxProps>(\n  color,\n  space,\n  layout,\n  flexbox,\n  border,\n  typography,\n  customBorder,\n  customBackground,\n  customOutline,\n  customShadow,\n  customExtra,\n  customTypography,\n  customLayout\n);\nclass MenuClass extends React.Component<IMenuProps, any> {\n  _container = null;\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      open: false,\n      menuState: STATES.HIDDEN,\n      top: 0,\n      left: 0,\n      menuWidth: 0,\n      menuHeight: 0,\n      buttonWidth: 0,\n      buttonHeight: 0,\n      menuSizeAnimation: new Animated.ValueXY({ x: 0, y: 0 }),\n      opacityAnimation: new Animated.Value(0),\n    };\n  }\n\n  _onMenuLayout = (e: any) => {\n    if (this.state.menuState === STATES.ANIMATING) {\n      return;\n    }\n    const { width, height } = e.nativeEvent.layout;\n    this.setState(\n      {\n        menuState: STATES.ANIMATING,\n        menuWidth: width,\n        menuHeight: height,\n      },\n      () => {\n        Animated.parallel([\n          Animated.timing(this.state.menuSizeAnimation, {\n            toValue: { x: width, y: height },\n            duration: Platform.OS === 'ios' ? animationDuration : 10,\n            easing: Easing.bezier(0.01, 1.3, 0.77, 0.91),\n            useNativeDriver: Platform.OS !== 'web',\n          }),\n          Animated.timing(this.state.opacityAnimation, {\n            toValue: 1,\n            duration: animationDuration,\n            easing: EASING,\n            useNativeDriver: Platform.OS !== 'web',\n          }),\n        ]).start();\n      }\n    );\n  };\n\n  show = () => {\n    if (this._container) {\n      // @ts-ignore\n      this._container.measureInWindow(\n        (left: any, top: any, buttonWidth: any, buttonHeight: any) => {\n          this.setState({\n            buttonHeight,\n            buttonWidth,\n            left,\n            menuState: STATES.SHOWN,\n            top,\n          });\n        }\n      );\n    }\n  };\n\n  hide = (onHidden?: any) => {\n    Animated.timing(this.state.opacityAnimation, {\n      toValue: 0,\n      duration: animationDuration,\n      easing: EASING,\n      useNativeDriver: Platform.OS !== 'web',\n    }).start(() => {\n      this.setState(\n        {\n          menuState: STATES.HIDDEN,\n          menuSizeAnimation: new Animated.ValueXY({ x: 0, y: 0 }),\n          opacityAnimation: new Animated.Value(0),\n        },\n        () => {\n          if (onHidden) {\n            onHidden();\n          }\n          if (Platform.OS !== 'ios' && this.props.onClose) {\n            this.props.onClose();\n          }\n        }\n      );\n    });\n  };\n\n  _hide = () => {\n    this.hide();\n  };\n  render() {\n    const {\n      menuSizeAnimation,\n      menuWidth,\n      menuHeight,\n      buttonWidth,\n      buttonHeight,\n      opacityAnimation,\n    } = this.state;\n\n    let { menuSize, menuContainerStyle } = getContainerStyles(\n      this.state.top,\n      this.state.left,\n      menuSizeAnimation,\n      menuWidth,\n      menuHeight,\n      buttonWidth,\n      buttonHeight,\n      opacityAnimation\n    );\n\n    const { menuState } = this.state;\n    const animationStarted = menuState === STATES.ANIMATING;\n    const modalVisible = menuState === STATES.SHOWN || animationStarted;\n    const {\n      testID,\n      trigger,\n      style,\n      children,\n      onOpen,\n      onClose,\n      closeOnSelect = true,\n    } = this.props;\n    const closeMenu = () => {\n      onClose && onClose();\n      this.hide();\n    };\n    let triggerElement: any = trigger\n      ? trigger(\n          {\n            onPress: () => {\n              if (this.state.open) {\n                closeMenu();\n              } else {\n                this.show();\n                onOpen && onOpen();\n              }\n            },\n          },\n          { open: this.state.open }\n        )\n      : null;\n    const [shadowContainerProps] = extractInObject(this.props, [\n      'borderRadius',\n      'bg',\n      'backgroundColor',\n      'shadowOffset',\n      'shadowColor',\n      'elevation',\n      'shadowOpacity',\n      'shadowRadius',\n    ]);\n    return (\n      <MenuContext.Provider\n        value={{ open: this.state.open, closeMenu, closeOnSelect }}\n      >\n        <View\n          ref={(ref: any) => {\n            this._container = ref;\n          }}\n          collapsable={false}\n          testID={testID}\n        >\n          {triggerElement}\n          <Modal\n            visible={modalVisible}\n            onRequestClose={this._hide}\n            supportedOrientations={[\n              'portrait',\n              'portrait-upside-down',\n              'landscape',\n              'landscape-left',\n              'landscape-right',\n            ]}\n            transparent\n          >\n            <TouchableWithoutFeedback onPress={this._hide}>\n              <View style={StyleSheet.absoluteFill}>\n                <StyleAnimatedView\n                  onLayout={this._onMenuLayout}\n                  position=\"absolute\"\n                  opacity={0}\n                  {...shadowContainerProps}\n                  style={[menuContainerStyle, style]}\n                >\n                  <StyleAnimatedView style={[animationStarted && menuSize]}>\n                    {children}\n                  </StyleAnimatedView>\n                </StyleAnimatedView>\n              </View>\n            </TouchableWithoutFeedback>\n          </Modal>\n        </View>\n      </MenuContext.Provider>\n    );\n  }\n}\n\nexport const Menu = (props: IMenuProps) => {\n  const newProps = usePropsConfig('Menu', props);\n  return <MenuClass {...newProps} />;\n};\n"]},"metadata":{},"sourceType":"script"}